var obj_requested = false;

function populate(dm){
    /*
    @param dm: DrawManager
    - grid
    - cube

     */

    if (!obj_requested){
        // readOBJFile("objects/Light Cycle/HQ_Movie_cycle.obj", 1, true);
        readOBJFile("objects/future-wheel/wheel.obj", 0.01, true);
        // readOBJFile("objects/cube/cube.obj", 1.0, true);

        obj_requested = true;
    }

    var drawing_info;
    if (g_objDoc != null && g_objDoc.isMTLComplete()){ // OBJ and all MTLs are available
        drawing_info = onReadComplete(g_objDoc);
        g_objDoc = null;
        console.log("loaded")
    }else{
        return false;
    }

    console.log(drawing_info.vertices.length + " " + drawing_info.indices.length);

    //grid
    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------
    var xx = GRID_WIDTH/2;
    var yy = GRID_WIDTH/2;

    var x = GRID_WIDTH;
    var y = GRID_WIDTH;

    var verticesGrid = [
        -xx, 0.0,  yy,
        -xx, 0.0,  -yy,
        xx, 0.0,  -yy,
        xx, 0.0,   yy
    ];


    // Colors
    var colorsGrid = [
        1,1,1,1,   1,1,1,1,   1,1,1,1,  1,1,1,1     // v0-v1-v2-v3 front
    ];

    // Normal
    var normalsGrid = [
        0.0, 1.0, 0.0,
        0.0, 1.0, 0.0,
        0.0, 1.0, 0.0,
        0.0, 1.0, 0.0,  // v0-v1-v2-v3 front
    ];

    // Indices of the vertices
    var indicesGrid = [
        0, 1, 2,   0, 2, 3    // front
    ];


    var texcoordsGrid = [
        0.0, y,
        0.0, 0.0,
        x, 0.0,
        x, y
    ];


    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------
    //cube
    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------


    var verticesCube = [
         0.5,  0.5,  0.5,  -0.5,  0.5,  0.5,  -0.5, -0.5,  0.5,   0.5, -0.5,  0.5, // v0-v1-v2-v3 front
         0.5,  0.5,  0.5,   0.5, -0.5,  0.5,   0.5, -0.5, -0.5,   0.5,  0.5, -0.5, // v0-v3-v4-v5 right
         0.5,  0.5,  0.5,   0.5,  0.5, -0.5,  -0.5,  0.5, -0.5,  -0.5,  0.5,  0.5, // v0-v5-v6-v1 up
        -0.5,  0.5,  0.5,  -0.5,  0.5, -0.5,  -0.5, -0.5, -0.5,  -0.5, -0.5,  0.5, // v1-v6-v7-v2 left
        -0.5, -0.5, -0.5,   0.5, -0.5, -0.5,   0.5, -0.5,  0.5,  -0.5, -0.5,  0.5, // v7-v4-v3-v2 down
         0.5, -0.5, -0.5,  -0.5, -0.5, -0.5,  -0.5,  0.5, -0.5,   0.5,  0.5, -0.5  // v4-v7-v6-v5 back
    ];

    // Colors
    var colorsCube = [
        1, 1, 1,1,   1, 1, 1,1,   1, 1, 1,1,  1, 1, 1,1,     // v0-v1-v2-v3 front
        1, 1, 1,1,   1, 1, 1,1,   1, 1, 1,1,  1, 1, 1,1,     // v0-v3-v4-v5 right
        1, 1, 1,1,   1, 1, 1,1,   1, 1, 1,1,  1, 1, 1,1,     // v0-v5-v6-v1 up
        1, 1, 1,1,   1, 1, 1,1,   1, 1, 1,1,  1, 1, 1,1,     // v1-v6-v7-v2 left
        1, 1, 1,1,   1, 1, 1,1,   1, 1, 1,1,  1, 1, 1,1,     // v7-v4-v3-v2 down
        1, 1, 1,1,   1, 1, 1,1,   1, 1, 1,1,  1, 1, 1,1,    // v4-v7-v6-v5 back
    ];

    // Normal
    var normalsCube = [
        0.0, 0.0, 1.0,   0.0, 0.0, 1.0,   0.0, 0.0, 1.0,   0.0, 0.0, 1.0,  // v0-v1-v2-v3 front
        1.0, 0.0, 0.0,   1.0, 0.0, 0.0,   1.0, 0.0, 0.0,   1.0, 0.0, 0.0,  // v0-v3-v4-v5 right
        0.0, 1.0, 0.0,   0.0, 1.0, 0.0,   0.0, 1.0, 0.0,   0.0, 1.0, 0.0,  // v0-v5-v6-v1 up
        -1.0, 0.0, 0.0,  -1.0, 0.0, 0.0,  -1.0, 0.0, 0.0,  -1.0, 0.0, 0.0,  // v1-v6-v7-v2 left
        0.0,-1.0, 0.0,   0.0,-1.0, 0.0,   0.0,-1.0, 0.0,   0.0,-1.0, 0.0,  // v7-v4-v3-v2 down
        0.0, 0.0,-1.0,   0.0, 0.0,-1.0,   0.0, 0.0,-1.0,   0.0, 0.0,-1.0   // v4-v7-v6-v5 back
    ];

    // Indices of the vertices
    var indicesCube = [
        0, 1, 2,   0, 2, 3,    // front
        4, 5, 6,   4, 6, 7,    // right
        8, 9,10,   8,10,11,    // up
        12,13,14,  12,14,15,    // left
        16,17,18,  16,18,19,    // down
        20,21,22,  20,22,23     // back
    ];

    var texcoordsCube = [
        0.0, 1.0,   0.0, 0.0,   1.0, 0.0,   1.0, 1.0,
        0.0, 1.0,   0.0, 0.0,   1.0, 0.0,   1.0, 1.0,
        0.0, 1.0,   0.0, 0.0,   1.0, 0.0,   1.0, 1.0,
        0.0, 1.0,   0.0, 0.0,   1.0, 0.0,   1.0, 1.0,
        0.0, 1.0,   0.0, 0.0,   1.0, 0.0,   1.0, 1.0,
        0.0, 1.0,   0.0, 0.0,   1.0, 0.0,   1.0, 1.0,
    ];



    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------
    //wall
    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------



    var verticesWall = [
        1.0, 1.0, 0.0,  -1.0, 1.0, 0.0,  -1.0,-1.0, 0.0,   1.0,-1.0, 0.0, // v0-v1-v2-v3 front
        // e.x, h,  e.y,   s.x, h, s.y,    s.x, 0.0, s.y,    e.x, 0.0, e.y, // v0-v1-v2-v3 front

        // 0.5, 0.5, 0.5,   0.5,-0.5, 0.5,   0.5,-0.5,-0.5,   0.5, 0.5,-0.5, // v0-v3-v4-v5 right
        // 0.5, 0.5, 0.5,   0.5, 0.5,-0.5,  -0.5, 0.5,-0.5,  -0.5, 0.5, 0.5, // v0-v5-v6-v1 up
        // -0.5, 0.5, 0.5,  -0.5, 0.5,-0.5,  -0.5,-0.5,-0.5,  -0.5,-0.5, 0.5, // v1-v6-v7-v2 left
        // -0.5,-0.5,-0.5,   0.5,-0.5,-0.5,   0.5,-0.5, 0.5,  -0.5,-0.5, 0.5, // v7-v4-v3-v2 down
        // 0.5,-0.5,-0.5,  -0.5,-0.5,-0.5,  -0.5, 0.5,-0.5,   0.5, 0.5,-0.5  // v4-v7-v6-v5 back
    ];

    // Colors
    var colorsWall = [
        1,1,1,1,   1,1,1,1,   1,1,1,1,  1,1,1,1     // v0-v1-v2-v3 front
        // 1, 0, 0,   1, 0, 0,   1, 0, 0,  1, 0, 0,     // v0-v3-v4-v5 right
        // 1, 0, 0,   1, 0, 0,   1, 0, 0,  1, 0, 0,     // v0-v5-v6-v1 up
        // 1, 0, 0,   1, 0, 0,   1, 0, 0,  1, 0, 0,     // v1-v6-v7-v2 left
        // 1, 0, 0,   1, 0, 0,   1, 0, 0,  1, 0, 0,     // v7-v4-v3-v2 down
        // 1, 0, 0,   1, 0, 0,   1, 0, 0,  1, 0, 0ã€€    // v4-v7-v6-v5 back
    ];

    // Normal
    var normalsWall = [
        0.0, 0.0, 1.0,   0.0, 0.0, 1.0,   0.0, 0.0, 1.0,   0.0, 0.0, 1.0,  // v0-v1-v2-v3 front
        // 1.0, 0.0, 0.0,   1.0, 0.0, 0.0,   1.0, 0.0, 0.0,   1.0, 0.0, 0.0,  // v0-v3-v4-v5 right
        // 0.0, 1.0, 0.0,   0.0, 1.0, 0.0,   0.0, 1.0, 0.0,   0.0, 1.0, 0.0,  // v0-v5-v6-v1 up
        // -1.0, 0.0, 0.0,  -1.0, 0.0, 0.0,  -1.0, 0.0, 0.0,  -1.0, 0.0, 0.0,  // v1-v6-v7-v2 left
        // 0.0,-1.0, 0.0,   0.0,-1.0, 0.0,   0.0,-1.0, 0.0,   0.0,-1.0, 0.0,  // v7-v4-v3-v2 down
        // 0.0, 0.0,-1.0,   0.0, 0.0,-1.0,   0.0, 0.0,-1.0,   0.0, 0.0,-1.0   // v4-v7-v6-v5 back
    ];

    // Indices of the vertices
    var indicesWall = [
        0, 1, 2,   0, 2, 3,    // front
        // 4, 5, 6,   4, 6, 7,    // right
        // 8, 9,10,   8,10,11,    // up
        // 12,13,14,  12,14,15,    // left
        // 16,17,18,  16,18,19,    // down
        // 20,21,22,  20,22,23     // back
    ];



    var texcoordsWall = [
        0.0, 1.0,
        0.0, 0.0,
        1.0, 0.0,
        1.0, 1.0
    ];


    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------
    //grid_wall
    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------
    //----------------------------------------------------------------------------------------------------




    // var verticesGridwall = [
    //      xx,  yy,  yy,     -xx,  yy,  yy,    -xx, -yy,  yy,    xx,-yy,  yy, // v0-v1-v2-v3 north
    //      xx,  yy,  yy,      xx, -yy,  yy,     xx, -yy, -yy,    xx, yy, -yy, // v0-v3-v4-v5 east
    //      xx, -yy, -yy,     -xx, -yy, -yy,    -xx,  yy, -yy,    xx, yy, -yy, // v4-v7-v6-v5 south
    //     -xx,  yy,  yy,     -xx,  yy, -yy,    -xx, -yy, -yy,   -xx,-yy,  yy, // v1-v6-v7-v2 west
    //
    // ];

    var verticesGridwall = [
        xx,  y,    yy,     -xx,  y,    yy,    -xx,  0.0,  yy,    xx, 0.0,  yy, // v0-v1-v2-v3 north
        xx,  y,    yy,      xx,  0.0,  yy,     xx,  0.0, -yy,    xx, y,   -yy, // v0-v3-v4-v5 west
        xx,  0.0, -yy,     -xx,  0.0, -yy,    -xx,  y,   -yy,    xx, y,   -yy, // v4-v7-v6-v5 south
        -xx,  y,    yy,     -xx,  y,   -yy,    -xx,  0.0, -yy,   -xx, 0.0,  yy, // v1-v6-v7-v2 east

    ];

    // va1

    // Colors
    var colorsGridwall = [
        1,1,1,1,   1,1,1,1,   1,1,1,1,  1,1,1,1,
        1,1,1,1,   1,1,1,1,   1,1,1,1,  1,1,1,1,
        1,1,1,1,   1,1,1,1,   1,1,1,1,  1,1,1,1,
        1,1,1,1,   1,1,1,1,   1,1,1,1,  1,1,1,1
    ];

    // Normal
    var normalsGridwall = [
        //north : front =
        0.0, 0.0,-1.0,   0.0, 0.0,-1.0,   0.0, 0.0,-1.0,   0.0, 0.0,-1.0,   // v4-v7-v6-v5 back
        -1.0, 0.0, 0.0,  -1.0, 0.0, 0.0,  -1.0, 0.0, 0.0,  -1.0, 0.0, 0.0,  // v1-v6-v7-v2 left
        0.0, 0.0, 1.0,   0.0, 0.0, 1.0,   0.0, 0.0, 1.0,   0.0, 0.0, 1.0,  // v0-v1-v2-v3 front
        1.0, 0.0, 0.0,   1.0, 0.0, 0.0,   1.0, 0.0, 0.0,   1.0, 0.0, 0.0,  // v0-v3-v4-v5 right

    ];

    // Indices of the vertices
    var indicesGridwall = [
        0, 1, 2,   0, 2, 3,    // north
        4, 5, 6,   4, 6, 7,    // east
        8, 9,10,   8,10,11,    // south
        12,13,14,  12,14,15,    // west

    ];


    var texcoordsGridwall = [
        0.0,  5.0,   0.0, 0.0,   5.0, 0.0,    5.0, 5.0,
        0.0,  5.0,   0.0, 0.0,   5.0, 0.0,    5.0, 5.0,
        0.0,  5.0,   0.0, 0.0,   5.0, 0.0,    5.0, 5.0,
        0.0,  5.0,   0.0, 0.0,   5.0, 0.0,    5.0, 5.0,
    ];


    //
    //---------------------------------------------------------------------------------------------------------
    //
    //add all data to DrawManager

    var texcoordsCycle = new Array(drawing_info.vertices.length/3*2).fill(0.0);
    dm.addObject("wheel",
        Array.prototype.slice.call(drawing_info.vertices),
        Array.prototype.slice.call(drawing_info.colors),
        Array.prototype.slice.call(drawing_info.normals),
        texcoordsCycle,
        Array.prototype.slice.call(drawing_info.indices)
    );
    dm.addObject("cube", verticesCube, colorsCube, normalsCube, texcoordsCube,indicesCube);
    dm.addObject("grid", verticesGrid, colorsGrid, normalsGrid, texcoordsGrid,indicesGrid);
    dm.addObject("wall", verticesWall, colorsWall, normalsWall, texcoordsWall,indicesWall);
    dm.addObject("grid_wall", verticesGridwall, colorsGridwall, normalsGridwall, texcoordsGridwall,indicesGridwall);

    return true;

}